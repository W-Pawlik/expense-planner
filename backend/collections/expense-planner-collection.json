{
  "info": {
    "_postman_id": "6e90a1d8-ea9b-48fd-9aa9-7f345c15b084",
    "name": "Expense Planner API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Health check",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/health"
      },
      "response": []
    },
    {
      "name": "Auth",
      "item": [
        {
          "name": "Register User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": "{{baseUrl}}/auth/register",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"login\": \"user1\",\n  \"email\": \"user1@example.com\",\n  \"password\": \"Password123\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"Status 201\", function () { pm.response.to.have.status(201); });",
                  "var data = pm.response.json();",
                  "pm.environment.set(\"userId\", data.user.id);"
                ]
              }
            }
          ]
        },
        {
          "name": "Login User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": "{{baseUrl}}/auth/login",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"login\": \"user1\",\n  \"password\": \"Password123\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"Status 200\", function () { pm.response.to.have.status(200); });",
                  "var data = pm.response.json();",
                  "pm.environment.set(\"userToken\", data.token);"
                ]
              }
            }
          ]
        },
        {
          "name": "Register Admin (optional - then set role=ADMIN in DB)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": "{{baseUrl}}/auth/register",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"login\": \"admin\",\n  \"email\": \"admin@example.com\",\n  \"password\": \"Admin123!\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"Status 201\", function () { pm.response.to.have.status(201); });",
                  "var data = pm.response.json();",
                  "pm.environment.set(\"adminUserId\", data.user.id);"
                ]
              }
            }
          ]
        },
        {
          "name": "Login Admin",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": "{{baseUrl}}/auth/login",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"login\": \"admin\",\n  \"password\": \"Admin123!\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"Status 200\", function () { pm.response.to.have.status(200); });",
                  "var data = pm.response.json();",
                  "pm.environment.set(\"adminToken\", data.token);"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "User",
      "item": [
        {
          "name": "Get current user (/users/userdata)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{userToken}}"
              }
            ],
            "url": "{{baseUrl}}/users/userdata"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Groups",
      "item": [
        {
          "name": "Create Group",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{userToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": "{{baseUrl}}/groups",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Mieszkanie\",\n  \"projectionYears\": 5,\n  \"visibilityStatus\": \"PRIVATE\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"Status 201\", function () { pm.response.to.have.status(201); });",
                  "var data = pm.response.json();",
                  "pm.environment.set(\"groupId\", data.id);"
                ]
              }
            }
          ]
        },
        {
          "name": "List My Groups",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{userToken}}"
              }
            ],
            "url": "{{baseUrl}}/groups"
          },
          "response": []
        },
        {
          "name": "Get Group Details",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{userToken}}"
              }
            ],
            "url": "{{baseUrl}}/groups/{{groupId}}"
          },
          "response": []
        },
        {
          "name": "Update Group",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{userToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": "{{baseUrl}}/groups/{{groupId}}",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Mieszkanie 2.0\"\n}"
            }
          },
          "response": []
        },
        {
          "name": "Change Group Visibility to PUBLIC",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{userToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": "{{baseUrl}}/groups/{{groupId}}/visibility",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"visibilityStatus\": \"PUBLIC\"\n}"
            }
          },
          "response": []
        },
        {
          "name": "Add Position to Group",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{userToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": "{{baseUrl}}/groups/{{groupId}}/positions",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Czynsz\",\n  \"amount\": 2000,\n  \"positionType\": \"EXPENSE\",\n  \"frequencyType\": \"RECURRING\",\n  \"notes\": \"PrzykÅ‚adowy komentarz\"\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"Status 201\", function () { pm.response.to.have.status(201); });",
                  "var data = pm.response.json();",
                  "pm.environment.set(\"positionId\", data.id);"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Position",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{userToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": "{{baseUrl}}/groups/{{groupId}}/positions/{{positionId}}",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"amount\": 2100\n}"
            }
          },
          "response": []
        },
        {
          "name": "Delete Position",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{userToken}}"
              }
            ],
            "url": "{{baseUrl}}/groups/{{groupId}}/positions/{{positionId}}"
          },
          "response": []
        },
        {
          "name": "Delete Group",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{userToken}}"
              }
            ],
            "url": "{{baseUrl}}/groups/{{groupId}}"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Board (Public)",
      "item": [
        {
          "name": "List Public Board Posts",
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/board"
          },
          "response": []
        },
        {
          "name": "Get Board Post Details",
          "request": {
            "method": "GET",
            "header": [],
            "url": "{{baseUrl}}/board/{{boardPostId}}"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Admin",
      "item": [
        {
          "name": "Admin - List Users",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": "{{baseUrl}}/admin/users"
          },
          "response": []
        },
        {
          "name": "Admin - List Pending Board Posts",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": "{{baseUrl}}/admin/board/pending"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"Status 200\", function () { pm.response.to.have.status(200); });",
                  "var data = pm.response.json();",
                  "if (data.posts && data.posts.length > 0) {",
                  "  pm.environment.set(\"boardPostId\", data.posts[0].id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Admin - Approve Board Post",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": "{{baseUrl}}/admin/board/posts/{{boardPostId}}/approve"
          },
          "response": []
        },
        {
          "name": "Admin - Reject Board Post",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": "{{baseUrl}}/admin/board/posts/{{boardPostId}}/reject"
          },
          "response": []
        }
      ]
    }
  ]
}
